<!-- HTML header for doxygen 1.8.19-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Control Surface: BluetoothMIDI_Interface.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/SVG"],
});
</script>
<script type="text/javascript" async="async" src="/MathJax/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300&family=Roboto:wght@400&family=Roboto:wght@500&display=swap" rel="stylesheet">
<link href="../../custom_stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Control Surface
   &#160;<span id="projectnumber"><code>new-input</code></span>
   </div>
   <div id="projectbrief">MIDI Control Surface library for Arduino</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../dir_6a6436ad46e42aad24bc1ce93af4f420.html">MIDI_Interfaces</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">BluetoothMIDI_Interface.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d8/d2c/BluetoothMIDI__Interface_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#if !defined(ARDUINO) || defined(ESP32) || defined(DOXYGEN)</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160; </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/ded/BluetoothMIDI__Interface_8hpp.html">BluetoothMIDI_Interface.hpp</a>&quot;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/dc7/midi_8h.html">BLEMIDI/ESP32/midi.h</a>&quot;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160; </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<a class="code" href="../../d0/da7/Settings_2NamespaceSettings_8hpp.html#a9432e3744c64fcf8e711ef91eff6a5cd">BEGIN_CS_NAMESPACE</a></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160; </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// -------------------------------------------------------------------------- //</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160; </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// The following section defines functions that send the MIDI BLE packets in</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// the background.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno"><a class="line" href="../../d0/d89/classBluetoothMIDI__Interface.html#aa6576f35a669d710636e2242432a1130">   13</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#aa6576f35a669d710636e2242432a1130">BluetoothMIDI_Interface::startSendingThread</a>() {</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    <span class="comment">// As long as you didn&#39;t get the stop signal, wait for data to send</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <span class="keyword">auto</span> send_loop = [<span class="keyword">this</span>] {</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;        <span class="keywordflow">while</span> (!<a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#ae0090fc21e6e632fc4510f57e29b5dea">stop_sending</a>)</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;            <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#ab6987415b7f83920cd43f1f34dd593ae">handleSendEvents</a>();</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    };</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="comment">// Need larger stack than default</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <a class="code" href="../../de/d27/structScopedThreadConfig.html">ScopedThreadConfig</a>(4096, 3, <span class="keyword">true</span>, <span class="stringliteral">&quot;SendBLEMIDI&quot;</span>);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="comment">// Launch the thread</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#ac0b97c3d43e512fc8118c01b655f2636">send_thread</a> = std::thread(send_loop);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;}</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="../../d0/d89/classBluetoothMIDI__Interface.html#ab6987415b7f83920cd43f1f34dd593ae">   25</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#ab6987415b7f83920cd43f1f34dd593ae">BluetoothMIDI_Interface::handleSendEvents</a>() {</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a1bf98c5cdd61db16f9ec0c30881d6588">lock_t</a> lock(<a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#ad5e0dbd36f0d71fce9b00b7f991b2f38">mtx</a>);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="comment">// Wait for a packet to be started (or for a stop signal)</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a0afa02d14fff34c480aabfbc41ad193c">cv</a>.wait(lock, [<span class="keyword">this</span>] { <span class="keywordflow">return</span> !<a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a81d8a08704c47d15c13785ce81719517">packetbuilder</a>.<a class="code" href="../../d7/d8e/classBLEMIDIPacketBuilder.html#a644718bb2fb240de962dc3c9a1fdf0dc">empty</a>() || <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#ae0090fc21e6e632fc4510f57e29b5dea">stop_sending</a>; });</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="comment">// Wait for flush signal or timeout</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordtype">bool</span> flushing = <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a0afa02d14fff34c480aabfbc41ad193c">cv</a>.wait_for(lock, <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a26727d2ea528cebfed726e19997ecadc">timeout</a>, [<span class="keyword">this</span>] { <span class="keywordflow">return</span> <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#ab9f84ac84f5789dc55463c2284486be2">flushnow</a>; });</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="comment">// Send the packet over BLE, empty the buffer, and update the buffer size</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="comment">// based on the MTU of the connected clients.</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a81d8a08704c47d15c13785ce81719517">packetbuilder</a>.<a class="code" href="../../d7/d8e/classBLEMIDIPacketBuilder.html#a644718bb2fb240de962dc3c9a1fdf0dc">empty</a>())</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#acb0235e1dec5da5120871d207b87586b">notifyMIDIBLE</a>(<a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a81d8a08704c47d15c13785ce81719517">packetbuilder</a>.<a class="code" href="../../d7/d8e/classBLEMIDIPacketBuilder.html#ada92d3f6590c15d194a997ace44a577b">getPacket</a>());</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a81d8a08704c47d15c13785ce81719517">packetbuilder</a>.<a class="code" href="../../d7/d8e/classBLEMIDIPacketBuilder.html#ad20897c5c8bd47f5d4005989bead0e55">reset</a>();</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a81d8a08704c47d15c13785ce81719517">packetbuilder</a>.<a class="code" href="../../d7/d8e/classBLEMIDIPacketBuilder.html#a2a81283fcd3295bbfb1a6b332e9fc593">setCapacity</a>(<a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#af9132080b7be05255873ea3c133c2748">min_mtu</a> - 3);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">// Notify the main thread that the flush was done</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordflow">if</span> (flushing) {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#ab9f84ac84f5789dc55463c2284486be2">flushnow</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        lock.unlock();</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a0afa02d14fff34c480aabfbc41ad193c">cv</a>.notify_one();</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    }</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;}</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="../../d0/d89/classBluetoothMIDI__Interface.html#a774b1cce4553aa2fe13aa42cc1cad3a1">   48</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a774b1cce4553aa2fe13aa42cc1cad3a1">BluetoothMIDI_Interface::flushImpl</a>(<a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a1bf98c5cdd61db16f9ec0c30881d6588">lock_t</a> &amp;lock) {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    assert(lock.owns_lock());</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="comment">// No need to send empty packets</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a81d8a08704c47d15c13785ce81719517">packetbuilder</a>.<a class="code" href="../../d7/d8e/classBLEMIDIPacketBuilder.html#a644718bb2fb240de962dc3c9a1fdf0dc">empty</a>())</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="comment">// Tell the background sender thread to send the packet now</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#ab9f84ac84f5789dc55463c2284486be2">flushnow</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    lock.unlock();</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a0afa02d14fff34c480aabfbc41ad193c">cv</a>.notify_one();</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="comment">// Wait for flush to complete (when the sender clears the flushnow flag)</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    lock.lock();</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a0afa02d14fff34c480aabfbc41ad193c">cv</a>.wait(lock, [<span class="keyword">this</span>] { <span class="keywordflow">return</span> !<a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#ab9f84ac84f5789dc55463c2284486be2">flushnow</a>; });</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    assert(lock.owns_lock());</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;}</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="../../d0/d89/classBluetoothMIDI__Interface.html#a87bc660c1a9bd50443efdf7037e68b13">   65</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a87bc660c1a9bd50443efdf7037e68b13">BluetoothMIDI_Interface::stopSendingThread</a>() {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="comment">// Tell the sender that this is the last packet</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#ae0090fc21e6e632fc4510f57e29b5dea">stop_sending</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">// Tell it to send the packet right now (flush)</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a1bf98c5cdd61db16f9ec0c30881d6588">lock_t</a> lock(<a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#ad5e0dbd36f0d71fce9b00b7f991b2f38">mtx</a>);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#ab9f84ac84f5789dc55463c2284486be2">flushnow</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    lock.unlock();</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a0afa02d14fff34c480aabfbc41ad193c">cv</a>.notify_one();</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="comment">// Wait for it to be sent, and join the thread when done</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#ac0b97c3d43e512fc8118c01b655f2636">send_thread</a>.joinable())</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#ac0b97c3d43e512fc8118c01b655f2636">send_thread</a>.join();</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;}</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">// -------------------------------------------------------------------------- //</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="preprocessor">#ifdef ARDUINO</span></div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="../../d0/d89/classBluetoothMIDI__Interface.html#acb0235e1dec5da5120871d207b87586b">   83</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#acb0235e1dec5da5120871d207b87586b">BluetoothMIDI_Interface::notifyMIDIBLE</a>(</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keyword">const</span> std::vector&lt;uint8_t&gt; &amp;packet) {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <a class="code" href="../../dc/dc7/midi_8h.html#aa600e500c302f6dfa01b183e0ef865c6">midi_notify</a>(packet.data(), packet.size());</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;}</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">// -------------------------------------------------------------------------- //</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">// The following section implements the MIDI sending functions.</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="../../d0/d89/classBluetoothMIDI__Interface.html#a31108ad1565c1ab32797d1574343b2df">   93</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a31108ad1565c1ab32797d1574343b2df">BluetoothMIDI_Interface::sendChannelMessageImpl</a>(<a class="code" href="../../d7/d3f/structChannelMessage.html">ChannelMessage</a> msg) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    msg.<a class="code" href="../../d7/d3f/structChannelMessage.html#afd23dd74db590cb5061ccc90da4d2291">hasTwoDataBytes</a>() ? <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#aa69dcb3b0685c862bcf4698b5ea3a13c">sendChannelMessageImpl3Bytes</a>(msg)</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                          : <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a85e6e468294dc1ac2fa67323aca1bed5">sendChannelMessageImpl2Bytes</a>(msg);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;}</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="../../d0/d89/classBluetoothMIDI__Interface.html#aa69dcb3b0685c862bcf4698b5ea3a13c">   98</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#aa69dcb3b0685c862bcf4698b5ea3a13c">BluetoothMIDI_Interface::sendChannelMessageImpl3Bytes</a>(<a class="code" href="../../d7/d3f/structChannelMessage.html">ChannelMessage</a> msg) {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment">// BLE packets are sent asynchronously, so we need a lock to access the</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">// packet buffer</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a1bf98c5cdd61db16f9ec0c30881d6588">lock_t</a> lock(<a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#ad5e0dbd36f0d71fce9b00b7f991b2f38">mtx</a>);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    uint16_t timestamp = millis();</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="comment">// Try adding the message to the current packet</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a81d8a08704c47d15c13785ce81719517">packetbuilder</a>.<a class="code" href="../../d7/d8e/classBLEMIDIPacketBuilder.html#aeea6539b85771e065d9b2a20265671b9">add3B</a>(msg.<a class="code" href="../../d4/d61/structMIDIMessage.html#a3707517cb22eb26bf33bbb859fb010d2">header</a>, msg.<a class="code" href="../../d4/d61/structMIDIMessage.html#a834ae4387b1eb95fa926d466f254e468">data1</a>, msg.<a class="code" href="../../d4/d61/structMIDIMessage.html#a147e14d13d9459cedff4ee049f231abf">data2</a>, timestamp)) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="comment">// If that doesn&#39;t work, flush the packet (send it now and wait until</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="comment">// it is sent)</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a774b1cce4553aa2fe13aa42cc1cad3a1">flushImpl</a>(lock);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="comment">// And then add it to the (now emtpy) buffer</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a81d8a08704c47d15c13785ce81719517">packetbuilder</a>.<a class="code" href="../../d7/d8e/classBLEMIDIPacketBuilder.html#aeea6539b85771e065d9b2a20265671b9">add3B</a>(msg.<a class="code" href="../../d4/d61/structMIDIMessage.html#a3707517cb22eb26bf33bbb859fb010d2">header</a>, msg.<a class="code" href="../../d4/d61/structMIDIMessage.html#a834ae4387b1eb95fa926d466f254e468">data1</a>, msg.<a class="code" href="../../d4/d61/structMIDIMessage.html#a147e14d13d9459cedff4ee049f231abf">data2</a>, timestamp);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="comment">// Notify the packet sender that data has been added to the buffer</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    lock.unlock();</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a0afa02d14fff34c480aabfbc41ad193c">cv</a>.notify_one();</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;}</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="../../d0/d89/classBluetoothMIDI__Interface.html#a85e6e468294dc1ac2fa67323aca1bed5">  116</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a85e6e468294dc1ac2fa67323aca1bed5">BluetoothMIDI_Interface::sendChannelMessageImpl2Bytes</a>(<a class="code" href="../../d7/d3f/structChannelMessage.html">ChannelMessage</a> msg) {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">// For comments, see</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">//   sendChannelMessageImpl3Bytes() above</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a1bf98c5cdd61db16f9ec0c30881d6588">lock_t</a> lock(<a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#ad5e0dbd36f0d71fce9b00b7f991b2f38">mtx</a>);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    uint16_t timestamp = millis();</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a81d8a08704c47d15c13785ce81719517">packetbuilder</a>.<a class="code" href="../../d7/d8e/classBLEMIDIPacketBuilder.html#a72e819256a3236668ca21796feebdb70">add2B</a>(msg.<a class="code" href="../../d4/d61/structMIDIMessage.html#a3707517cb22eb26bf33bbb859fb010d2">header</a>, msg.<a class="code" href="../../d4/d61/structMIDIMessage.html#a834ae4387b1eb95fa926d466f254e468">data1</a>, timestamp)) {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a774b1cce4553aa2fe13aa42cc1cad3a1">flushImpl</a>(lock);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a81d8a08704c47d15c13785ce81719517">packetbuilder</a>.<a class="code" href="../../d7/d8e/classBLEMIDIPacketBuilder.html#a72e819256a3236668ca21796feebdb70">add2B</a>(msg.<a class="code" href="../../d4/d61/structMIDIMessage.html#a3707517cb22eb26bf33bbb859fb010d2">header</a>, msg.<a class="code" href="../../d4/d61/structMIDIMessage.html#a834ae4387b1eb95fa926d466f254e468">data1</a>, timestamp);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    }</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    lock.unlock();</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a0afa02d14fff34c480aabfbc41ad193c">cv</a>.notify_one();</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;}</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="../../d0/d89/classBluetoothMIDI__Interface.html#a621e44a535a138a59ffd3681dab224b6">  129</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a621e44a535a138a59ffd3681dab224b6">BluetoothMIDI_Interface::sendRealTimeImpl</a>(<a class="code" href="../../d6/d99/structRealTimeMessage.html">RealTimeMessage</a> msg) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">// For comments, see</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">//   sendChannelMessageImpl3Bytes() above</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a1bf98c5cdd61db16f9ec0c30881d6588">lock_t</a> lock(<a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#ad5e0dbd36f0d71fce9b00b7f991b2f38">mtx</a>);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    uint16_t timestamp = millis();</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a81d8a08704c47d15c13785ce81719517">packetbuilder</a>.<a class="code" href="../../d7/d8e/classBLEMIDIPacketBuilder.html#aa66e5a45f2dbd33f6803a1dbbe4882ba">addRealTime</a>(msg.<a class="code" href="../../d6/d99/structRealTimeMessage.html#a70458cf1b28859e94ae35dfe6df1a497">message</a>, timestamp)) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a774b1cce4553aa2fe13aa42cc1cad3a1">flushImpl</a>(lock);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a81d8a08704c47d15c13785ce81719517">packetbuilder</a>.<a class="code" href="../../d7/d8e/classBLEMIDIPacketBuilder.html#aa66e5a45f2dbd33f6803a1dbbe4882ba">addRealTime</a>(msg.<a class="code" href="../../d6/d99/structRealTimeMessage.html#a70458cf1b28859e94ae35dfe6df1a497">message</a>, timestamp);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    lock.unlock();</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a0afa02d14fff34c480aabfbc41ad193c">cv</a>.notify_one();</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;}</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="../../d0/d89/classBluetoothMIDI__Interface.html#a956d5768bb3ec516505f447ca3062f81">  142</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a956d5768bb3ec516505f447ca3062f81">BluetoothMIDI_Interface::sendSysExImpl</a>(<a class="code" href="../../db/d45/structSysExMessage.html">SysExMessage</a> msg) {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a1bf98c5cdd61db16f9ec0c30881d6588">lock_t</a> lock(<a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#ad5e0dbd36f0d71fce9b00b7f991b2f38">mtx</a>);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordtype">size_t</span> length = msg.<a class="code" href="../../db/d45/structSysExMessage.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keyword">const</span> uint8_t *data = msg.<a class="code" href="../../db/d45/structSysExMessage.html#a579f5164b5b16e18ddcdb0296ef81799">data</a>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    uint16_t timestamp = millis(); <span class="comment">// BLE MIDI timestamp</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment">// TODO: I have no idea why, but the last byte gets cut off when the LSB</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">// of the timestamp is 0x77 ... (Problem is probably in the BlueZ parser)</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">if</span> ((timestamp &amp; 0x77) == 0x77)</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        timestamp &amp;= 0xFFFE;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="comment">// Try adding at least the SysExStart header to the current packet</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a81d8a08704c47d15c13785ce81719517">packetbuilder</a>.<a class="code" href="../../d7/d8e/classBLEMIDIPacketBuilder.html#a4355f549204eea18fdd652378fa92243">addSysEx</a>(data, length, timestamp)) {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="comment">// If that didn&#39;t fit, flush the packet</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a774b1cce4553aa2fe13aa42cc1cad3a1">flushImpl</a>(lock);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="comment">// Add the first part of the SysEx message to this packet</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a81d8a08704c47d15c13785ce81719517">packetbuilder</a>.<a class="code" href="../../d7/d8e/classBLEMIDIPacketBuilder.html#a4355f549204eea18fdd652378fa92243">addSysEx</a>(data, length, timestamp);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="comment">// As long as there&#39;s data to be sent in the next packet</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordflow">while</span> (data) {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="comment">// Send the previous (full) packet</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a774b1cce4553aa2fe13aa42cc1cad3a1">flushImpl</a>(lock);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="comment">// And add the next part of the SysEx message to a continuation packet</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a81d8a08704c47d15c13785ce81719517">packetbuilder</a>.<a class="code" href="../../d7/d8e/classBLEMIDIPacketBuilder.html#a2c7ed84a517b162234e17b06b11b66a1">continueSysEx</a>(data, length, timestamp);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">// Notify the packet sender that data has been added to the buffer</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    lock.unlock();</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a0afa02d14fff34c480aabfbc41ad193c">cv</a>.notify_one();</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;}</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">// -------------------------------------------------------------------------- //</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno"><a class="line" href="../../d0/d89/classBluetoothMIDI__Interface.html#a3c3a2d56c1a465c8f8356d6e40c7ad61">  174</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a3c3a2d56c1a465c8f8356d6e40c7ad61">BluetoothMIDI_Interface::parse</a>(<span class="keyword">const</span> uint8_t *<span class="keyword">const</span> data,</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">size_t</span> len) {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keyword">auto</span> mididata = <a class="code" href="../../d9/d19/classBLEMIDIParser.html">BLEMIDIParser</a>(data, len);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="../../d1/d70/MIDIReadEvent_8hpp.html#a16d614a4b221d351c71d73a72820c029">MIDIReadEvent</a> <span class="keyword">event</span> = <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#afcb1a2d039abd7b9058d2d224936a901">parser</a>.<a class="code" href="../../d0/d0d/classSerialMIDI__Parser.html#a9b4887f4c5b19d9b45134558804d3659">pull</a>(mididata);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="comment">// TODO: add a timeout instead of busy waiting?</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">while</span> (event != <a class="code" href="../../d1/d70/MIDIReadEvent_8hpp.html#a16d614a4b221d351c71d73a72820c029a3b6e8876bb7ebb1a30be0d1611780f7a">MIDIReadEvent::NO_MESSAGE</a>) {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <a class="code" href="../../d4/da5/group__AH__Debug.html#ga5e1b7520df0706433ae295a78471fb3c">DEBUGFN</a>(event);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="keywordflow">switch</span> (event) {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d1/d70/MIDIReadEvent_8hpp.html#a16d614a4b221d351c71d73a72820c029a1059c30ffa7691a2219835859583bda2">MIDIReadEvent::CHANNEL_MESSAGE</a>:</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                <span class="keywordflow">while</span> (!<a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a8440b5741ad49bee352994b5502382ad">queue</a>.<a class="code" href="../../d6/d71/classMIDIMessageQueue.html#afc9078484775fa28a47f1c5529b36cc6">push</a>(<a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#afcb1a2d039abd7b9058d2d224936a901">parser</a>.<a class="code" href="../../df/d0c/classMIDI__Parser.html#a04c9d2d0564e73d40705476583ec8faa">getChannelMessage</a>()))</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                    std::this_thread::yield();</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d1/d70/MIDIReadEvent_8hpp.html#a16d614a4b221d351c71d73a72820c029a2abfc861b1d858a222dd09c5fef5df4b">MIDIReadEvent::SYSEX_CHUNK</a>: <span class="comment">// fallthrough</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d1/d70/MIDIReadEvent_8hpp.html#a16d614a4b221d351c71d73a72820c029a8f1280ad8f91d7f5b430d906c1a272ef">MIDIReadEvent::SYSEX_MESSAGE</a>:</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                <span class="keywordflow">while</span> (!<a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a8440b5741ad49bee352994b5502382ad">queue</a>.<a class="code" href="../../d6/d71/classMIDIMessageQueue.html#afc9078484775fa28a47f1c5529b36cc6">push</a>(<a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#afcb1a2d039abd7b9058d2d224936a901">parser</a>.<a class="code" href="../../d0/d0d/classSerialMIDI__Parser.html#ae3a623951f55462fb1a5925252ac1c55">getSysExMessage</a>()))</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                    std::this_thread::yield();</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d1/d70/MIDIReadEvent_8hpp.html#a16d614a4b221d351c71d73a72820c029a8f3bdd6b6cc8ea9bc4be3a5783055d20">MIDIReadEvent::REALTIME_MESSAGE</a>:</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                <span class="keywordflow">while</span> (!<a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a8440b5741ad49bee352994b5502382ad">queue</a>.<a class="code" href="../../d6/d71/classMIDIMessageQueue.html#afc9078484775fa28a47f1c5529b36cc6">push</a>(<a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#afcb1a2d039abd7b9058d2d224936a901">parser</a>.<a class="code" href="../../df/d0c/classMIDI__Parser.html#a0655ff0c22f4e0d024e9b3aad75e51d1">getRealTimeMessage</a>()))</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                    std::this_thread::yield();</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d1/d70/MIDIReadEvent_8hpp.html#a16d614a4b221d351c71d73a72820c029a350769b04fa8903e4e1a11c37c8303f3">MIDIReadEvent::SYSCOMMON_MESSAGE</a>:</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                <span class="keywordflow">while</span> (!<a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a8440b5741ad49bee352994b5502382ad">queue</a>.<a class="code" href="../../d6/d71/classMIDIMessageQueue.html#afc9078484775fa28a47f1c5529b36cc6">push</a>(<a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#afcb1a2d039abd7b9058d2d224936a901">parser</a>.<a class="code" href="../../df/d0c/classMIDI__Parser.html#a619f40e8b17dcb767df39bedc878ab50">getSysCommonMessage</a>()))</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                    std::this_thread::yield();</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d1/d70/MIDIReadEvent_8hpp.html#a16d614a4b221d351c71d73a72820c029a3b6e8876bb7ebb1a30be0d1611780f7a">MIDIReadEvent::NO_MESSAGE</a>: <span class="keywordflow">break</span>; <span class="comment">// LCOV_EXCL_LINE</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;                        <span class="comment">// LCOV_EXCL_LINE</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keyword">event</span> = <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#afcb1a2d039abd7b9058d2d224936a901">parser</a>.<a class="code" href="../../d0/d0d/classSerialMIDI__Parser.html#a9b4887f4c5b19d9b45134558804d3659">pull</a>(mididata);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;}</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno"><a class="line" href="../../d0/d89/classBluetoothMIDI__Interface.html#adb02fa6b9ddb7404758bcad36115a26e">  206</a></span>&#160;<a class="code" href="../../d1/d70/MIDIReadEvent_8hpp.html#a16d614a4b221d351c71d73a72820c029">MIDIReadEvent</a> <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#adb02fa6b9ddb7404758bcad36115a26e">BluetoothMIDI_Interface::read</a>() {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">// Pop a new message from the queue</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a8440b5741ad49bee352994b5502382ad">queue</a>.<a class="code" href="../../d6/d71/classMIDIMessageQueue.html#ad163f033645fb890e0b314dd4ec14302">pop</a>(<a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a2a4f9d46c675709ce37c03869740ce01">incomingMessage</a>))</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d1/d70/MIDIReadEvent_8hpp.html#a16d614a4b221d351c71d73a72820c029a3b6e8876bb7ebb1a30be0d1611780f7a">MIDIReadEvent::NO_MESSAGE</a>;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a2a4f9d46c675709ce37c03869740ce01">incomingMessage</a>.<a class="code" href="../../d9/d4b/structMIDIMessageQueue_1_1MIDIMessageQueueElement.html#a108a96f1654fb7609ad870e9bbdc6470">eventType</a>;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;}</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno"><a class="line" href="../../d0/d89/classBluetoothMIDI__Interface.html#a04c9d2d0564e73d40705476583ec8faa">  213</a></span>&#160;<a class="code" href="../../d7/d3f/structChannelMessage.html">ChannelMessage</a> <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a04c9d2d0564e73d40705476583ec8faa">BluetoothMIDI_Interface::getChannelMessage</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a2a4f9d46c675709ce37c03869740ce01">incomingMessage</a>.<a class="code" href="../../d9/d4b/structMIDIMessageQueue_1_1MIDIMessageQueueElement.html#a108a96f1654fb7609ad870e9bbdc6470">eventType</a> == <a class="code" href="../../d1/d70/MIDIReadEvent_8hpp.html#a16d614a4b221d351c71d73a72820c029a1059c30ffa7691a2219835859583bda2">MIDIReadEvent::CHANNEL_MESSAGE</a></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;               ? <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a2a4f9d46c675709ce37c03869740ce01">incomingMessage</a>.<a class="code" href="../../d9/d4b/structMIDIMessageQueue_1_1MIDIMessageQueueElement.html#a305d0016a932f263f616fd5df16ab382">message</a>.<a class="code" href="../../db/d98/unionMIDIMessageQueue_1_1MIDIMessageQueueElement_1_1Message.html#a60a0af53c10ec0c1174ae9e9ec51facd">channelmessage</a></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;               : <a class="code" href="../../d7/d3f/structChannelMessage.html">ChannelMessage</a>(0, 0, 0);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;}</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno"><a class="line" href="../../d0/d89/classBluetoothMIDI__Interface.html#a619f40e8b17dcb767df39bedc878ab50">  219</a></span>&#160;<a class="code" href="../../d5/dad/structSysCommonMessage.html">SysCommonMessage</a> <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a619f40e8b17dcb767df39bedc878ab50">BluetoothMIDI_Interface::getSysCommonMessage</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a2a4f9d46c675709ce37c03869740ce01">incomingMessage</a>.<a class="code" href="../../d9/d4b/structMIDIMessageQueue_1_1MIDIMessageQueueElement.html#a108a96f1654fb7609ad870e9bbdc6470">eventType</a> == <a class="code" href="../../d1/d70/MIDIReadEvent_8hpp.html#a16d614a4b221d351c71d73a72820c029a350769b04fa8903e4e1a11c37c8303f3">MIDIReadEvent::SYSCOMMON_MESSAGE</a></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;               ? <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a2a4f9d46c675709ce37c03869740ce01">incomingMessage</a>.<a class="code" href="../../d9/d4b/structMIDIMessageQueue_1_1MIDIMessageQueueElement.html#a305d0016a932f263f616fd5df16ab382">message</a>.<a class="code" href="../../db/d98/unionMIDIMessageQueue_1_1MIDIMessageQueueElement_1_1Message.html#a9b71af9a038fbd69b126cbaa374b2ed4">syscommonmessage</a></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;               : <a class="code" href="../../d5/dad/structSysCommonMessage.html">SysCommonMessage</a>(0, 0, 0);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;}</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="../../d0/d89/classBluetoothMIDI__Interface.html#a0655ff0c22f4e0d024e9b3aad75e51d1">  225</a></span>&#160;<a class="code" href="../../d6/d99/structRealTimeMessage.html">RealTimeMessage</a> <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a0655ff0c22f4e0d024e9b3aad75e51d1">BluetoothMIDI_Interface::getRealTimeMessage</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a2a4f9d46c675709ce37c03869740ce01">incomingMessage</a>.<a class="code" href="../../d9/d4b/structMIDIMessageQueue_1_1MIDIMessageQueueElement.html#a108a96f1654fb7609ad870e9bbdc6470">eventType</a> == <a class="code" href="../../d1/d70/MIDIReadEvent_8hpp.html#a16d614a4b221d351c71d73a72820c029a8f3bdd6b6cc8ea9bc4be3a5783055d20">MIDIReadEvent::REALTIME_MESSAGE</a></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;               ? <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a2a4f9d46c675709ce37c03869740ce01">incomingMessage</a>.<a class="code" href="../../d9/d4b/structMIDIMessageQueue_1_1MIDIMessageQueueElement.html#a305d0016a932f263f616fd5df16ab382">message</a>.<a class="code" href="../../db/d98/unionMIDIMessageQueue_1_1MIDIMessageQueueElement_1_1Message.html#a8bced99b947fdc61bdbd02a1fdd55c7a">realtimemessage</a></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;               : <a class="code" href="../../d6/d99/structRealTimeMessage.html">RealTimeMessage</a>(0);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;}</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno"><a class="line" href="../../d0/d89/classBluetoothMIDI__Interface.html#ae3a623951f55462fb1a5925252ac1c55">  231</a></span>&#160;<a class="code" href="../../db/d45/structSysExMessage.html">SysExMessage</a> <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#ae3a623951f55462fb1a5925252ac1c55">BluetoothMIDI_Interface::getSysExMessage</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keyword">auto</span> evt = <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a2a4f9d46c675709ce37c03869740ce01">incomingMessage</a>.<a class="code" href="../../d9/d4b/structMIDIMessageQueue_1_1MIDIMessageQueueElement.html#a108a96f1654fb7609ad870e9bbdc6470">eventType</a>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordtype">bool</span> hasSysEx = evt == <a class="code" href="../../d1/d70/MIDIReadEvent_8hpp.html#a16d614a4b221d351c71d73a72820c029a8f1280ad8f91d7f5b430d906c1a272ef">MIDIReadEvent::SYSEX_MESSAGE</a> ||</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                    evt == <a class="code" href="../../d1/d70/MIDIReadEvent_8hpp.html#a16d614a4b221d351c71d73a72820c029a2abfc861b1d858a222dd09c5fef5df4b">MIDIReadEvent::SYSEX_CHUNK</a>;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordflow">return</span> hasSysEx ? <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a2a4f9d46c675709ce37c03869740ce01">incomingMessage</a>.<a class="code" href="../../d9/d4b/structMIDIMessageQueue_1_1MIDIMessageQueueElement.html#a305d0016a932f263f616fd5df16ab382">message</a>.<a class="code" href="../../db/d98/unionMIDIMessageQueue_1_1MIDIMessageQueueElement_1_1Message.html#ac3130b4646bb682acc184d6fac12671a">sysexmessage</a></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                    : <a class="code" href="../../db/d45/structSysExMessage.html">SysExMessage</a>(<span class="keyword">nullptr</span>, 0);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;}</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">// -------------------------------------------------------------------------- //</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno"><a class="line" href="../../d0/d89/classBluetoothMIDI__Interface.html#adb225c79278fe437cdbcef7569e7e3fc">  241</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#adb225c79278fe437cdbcef7569e7e3fc">BluetoothMIDI_Interface::updateMTU</a>(uint16_t mtu) {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    uint16_t force_min_mtu_c = <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a65e5fa6951d8a96b57efbb0d8faf8fee">force_min_mtu</a>;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordflow">if</span> (force_min_mtu_c == 0)</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#af9132080b7be05255873ea3c133c2748">min_mtu</a> = mtu;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#af9132080b7be05255873ea3c133c2748">min_mtu</a> = <a class="code" href="../../dd/d5e/group__AH__Math.html#ga5e07739c1fd7a29e6b2840237af7f1bc">std::min</a>(force_min_mtu_c, mtu);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <a class="code" href="../../d4/da5/group__AH__Debug.html#ga5e1b7520df0706433ae295a78471fb3c">DEBUGFN</a>(<a class="code" href="../../d4/da5/group__AH__Debug.html#ga35654913b4a1f9d9300f847fab14b3d3">NAMEDVALUE</a>(<a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#af9132080b7be05255873ea3c133c2748">min_mtu</a>));</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a1bf98c5cdd61db16f9ec0c30881d6588">lock_t</a> lock(<a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#ad5e0dbd36f0d71fce9b00b7f991b2f38">mtx</a>);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a81d8a08704c47d15c13785ce81719517">packetbuilder</a>.<a class="code" href="../../d7/d8e/classBLEMIDIPacketBuilder.html#a2935e02624493a655bf6933d816202a1">getSize</a>() == 0)</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a81d8a08704c47d15c13785ce81719517">packetbuilder</a>.<a class="code" href="../../d7/d8e/classBLEMIDIPacketBuilder.html#a2a81283fcd3295bbfb1a6b332e9fc593">setCapacity</a>(<a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#af9132080b7be05255873ea3c133c2748">min_mtu</a> - 3);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;}</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno"><a class="line" href="../../d0/d89/classBluetoothMIDI__Interface.html#a3e2e81eeb421a671b7444665f87a1068">  253</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a3e2e81eeb421a671b7444665f87a1068">BluetoothMIDI_Interface::forceMinMTU</a>(uint16_t mtu) {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a65e5fa6951d8a96b57efbb0d8faf8fee">force_min_mtu</a> = mtu;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#adb225c79278fe437cdbcef7569e7e3fc">updateMTU</a>(<a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#af9132080b7be05255873ea3c133c2748">min_mtu</a>);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;}</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">// -------------------------------------------------------------------------- //</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno"><a class="line" href="../../d8/d2c/BluetoothMIDI__Interface_8cpp.html#a65de74b76735d018f6c197aa47a0c343">  260</a></span>&#160;<span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span> <a class="code" href="../../d8/d2c/BluetoothMIDI__Interface_8cpp.html#a65de74b76735d018f6c197aa47a0c343">BluetoothMIDI_Interface_midi_mtu_callback</a>(uint16_t mtu) {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a9bc7ba36e0b11965a1db3594c6e59261">BluetoothMIDI_Interface::midi_mtu_callback</a>(mtu);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;}</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno"><a class="line" href="../../d8/d2c/BluetoothMIDI__Interface_8cpp.html#ae95f7b5532151b0050672cbebc077ad6">  264</a></span>&#160;<span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span> <a class="code" href="../../d8/d2c/BluetoothMIDI__Interface_8cpp.html#ae95f7b5532151b0050672cbebc077ad6">BluetoothMIDI_Interface_midi_write_callback</a>(<span class="keyword">const</span> uint8_t *data,</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                                                            <span class="keywordtype">size_t</span> length) {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#affc217586537ff5c090cd97874c16175">BluetoothMIDI_Interface::midi_write_callback</a>(data, length);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;}</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">// -------------------------------------------------------------------------- //</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno"><a class="line" href="../../d0/d89/classBluetoothMIDI__Interface.html#a7c3e14d99bd3dc0e3670d6956dafcaf2">  271</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a7c3e14d99bd3dc0e3670d6956dafcaf2">BluetoothMIDI_Interface::begin</a>() {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="preprocessor">#ifdef ARDUINO</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <a class="code" href="../../dc/dc7/midi_8h.html#a9d22b3d6becc73fe2ed32e563cdae100">midi_set_mtu_callback</a>(<a class="code" href="../../d8/d2c/BluetoothMIDI__Interface_8cpp.html#a65de74b76735d018f6c197aa47a0c343">BluetoothMIDI_Interface_midi_mtu_callback</a>);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <a class="code" href="../../dc/dc7/midi_8h.html#a87000ead29f63a1b923aab803bdb775f">midi_set_write_callback</a>(<a class="code" href="../../d8/d2c/BluetoothMIDI__Interface_8cpp.html#ae95f7b5532151b0050672cbebc077ad6">BluetoothMIDI_Interface_midi_write_callback</a>);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <a class="code" href="../../d4/da5/group__AH__Debug.html#ga5e1b7520df0706433ae295a78471fb3c">DEBUGFN</a>(<a class="code" href="../../d7/d78/namespaceMIDI__Notes.html#a782ecf472467d5b568ea62a533489807">F</a>(<span class="stringliteral">&quot;Initializing BLE MIDI Interface&quot;</span>));</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../dc/dc7/midi_8h.html#a57981a470092a596f6e0058b9b8e0aa5">midi_init</a>()) {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <a class="code" href="../../d0/df7/group__AH__Error.html#ga7eae7037bf6cdc6bf5d46a11572194db">ERROR</a>(<a class="code" href="../../d7/d78/namespaceMIDI__Notes.html#a782ecf472467d5b568ea62a533489807">F</a>(<span class="stringliteral">&quot;Error initializing BLE MIDI interface&quot;</span>), 0x2022);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#aa6576f35a669d710636e2242432a1130">startSendingThread</a>();</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;}</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno"><a class="line" href="../../d0/d89/classBluetoothMIDI__Interface.html#aaf81d3fdaf258088d7692fa70cece087">  284</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#aaf81d3fdaf258088d7692fa70cece087">BluetoothMIDI_Interface::end</a>() {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="preprocessor">#ifdef ARDUINO</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <a class="code" href="../../d4/da5/group__AH__Debug.html#ga5e1b7520df0706433ae295a78471fb3c">DEBUGFN</a>(<a class="code" href="../../d7/d78/namespaceMIDI__Notes.html#a782ecf472467d5b568ea62a533489807">F</a>(<span class="stringliteral">&quot;Deinitializing BLE MIDI Interface&quot;</span>));</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../dc/dc7/midi_8h.html#a25cd3ab0c944e5cb12316b79cb1e3566">midi_deinit</a>()) {</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <a class="code" href="../../d0/df7/group__AH__Error.html#ga7eae7037bf6cdc6bf5d46a11572194db">ERROR</a>(<a class="code" href="../../d7/d78/namespaceMIDI__Notes.html#a782ecf472467d5b568ea62a533489807">F</a>(<span class="stringliteral">&quot;Error deinitializing BLE MIDI interface&quot;</span>), 0x2023);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;}</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">// -------------------------------------------------------------------------- //</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html">BluetoothMIDI_Interface</a> *<a class="code" href="../../d0/d89/classBluetoothMIDI__Interface.html#a5fd9976d3d7ba5d9658abf107ea3003a">BluetoothMIDI_Interface::instance</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<a class="code" href="../../d0/da7/Settings_2NamespaceSettings_8hpp.html#a9305dd4bad1398506431b42a5a100f8d">END_CS_NAMESPACE</a></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="ttc" id="aBluetoothMIDI__Interface_8cpp_html_a65de74b76735d018f6c197aa47a0c343"><div class="ttname"><a href="../../d8/d2c/BluetoothMIDI__Interface_8cpp.html#a65de74b76735d018f6c197aa47a0c343">BluetoothMIDI_Interface_midi_mtu_callback</a></div><div class="ttdeci">void BluetoothMIDI_Interface_midi_mtu_callback(uint16_t mtu)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d2c/BluetoothMIDI__Interface_8cpp_source.html#l00260">BluetoothMIDI_Interface.cpp:260</a></div></div>
<div class="ttc" id="aBluetoothMIDI__Interface_8cpp_html_ae95f7b5532151b0050672cbebc077ad6"><div class="ttname"><a href="../../d8/d2c/BluetoothMIDI__Interface_8cpp.html#ae95f7b5532151b0050672cbebc077ad6">BluetoothMIDI_Interface_midi_write_callback</a></div><div class="ttdeci">void BluetoothMIDI_Interface_midi_write_callback(const uint8_t *data, size_t length)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d2c/BluetoothMIDI__Interface_8cpp_source.html#l00264">BluetoothMIDI_Interface.cpp:264</a></div></div>
<div class="ttc" id="aBluetoothMIDI__Interface_8hpp_html"><div class="ttname"><a href="../../df/ded/BluetoothMIDI__Interface_8hpp.html">BluetoothMIDI_Interface.hpp</a></div></div>
<div class="ttc" id="aMIDIReadEvent_8hpp_html_a16d614a4b221d351c71d73a72820c029"><div class="ttname"><a href="../../d1/d70/MIDIReadEvent_8hpp.html#a16d614a4b221d351c71d73a72820c029">MIDIReadEvent</a></div><div class="ttdeci">MIDIReadEvent</div><div class="ttdoc">Values returned by the MIDI reading functions.</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d70/MIDIReadEvent_8hpp_source.html#l00011">MIDIReadEvent.hpp:11</a></div></div>
<div class="ttc" id="aMIDIReadEvent_8hpp_html_a16d614a4b221d351c71d73a72820c029a1059c30ffa7691a2219835859583bda2"><div class="ttname"><a href="../../d1/d70/MIDIReadEvent_8hpp.html#a16d614a4b221d351c71d73a72820c029a1059c30ffa7691a2219835859583bda2">MIDIReadEvent::CHANNEL_MESSAGE</a></div><div class="ttdeci">@ CHANNEL_MESSAGE</div><div class="ttdoc">A MIDI Channel message was received.</div></div>
<div class="ttc" id="aMIDIReadEvent_8hpp_html_a16d614a4b221d351c71d73a72820c029a2abfc861b1d858a222dd09c5fef5df4b"><div class="ttname"><a href="../../d1/d70/MIDIReadEvent_8hpp.html#a16d614a4b221d351c71d73a72820c029a2abfc861b1d858a222dd09c5fef5df4b">MIDIReadEvent::SYSEX_CHUNK</a></div><div class="ttdeci">@ SYSEX_CHUNK</div><div class="ttdoc">An incomplete System Exclusive message.</div></div>
<div class="ttc" id="aMIDIReadEvent_8hpp_html_a16d614a4b221d351c71d73a72820c029a350769b04fa8903e4e1a11c37c8303f3"><div class="ttname"><a href="../../d1/d70/MIDIReadEvent_8hpp.html#a16d614a4b221d351c71d73a72820c029a350769b04fa8903e4e1a11c37c8303f3">MIDIReadEvent::SYSCOMMON_MESSAGE</a></div><div class="ttdeci">@ SYSCOMMON_MESSAGE</div><div class="ttdoc">A MIDI System Common message was received.</div></div>
<div class="ttc" id="aMIDIReadEvent_8hpp_html_a16d614a4b221d351c71d73a72820c029a3b6e8876bb7ebb1a30be0d1611780f7a"><div class="ttname"><a href="../../d1/d70/MIDIReadEvent_8hpp.html#a16d614a4b221d351c71d73a72820c029a3b6e8876bb7ebb1a30be0d1611780f7a">MIDIReadEvent::NO_MESSAGE</a></div><div class="ttdeci">@ NO_MESSAGE</div><div class="ttdoc">No new messages were received.</div></div>
<div class="ttc" id="aMIDIReadEvent_8hpp_html_a16d614a4b221d351c71d73a72820c029a8f1280ad8f91d7f5b430d906c1a272ef"><div class="ttname"><a href="../../d1/d70/MIDIReadEvent_8hpp.html#a16d614a4b221d351c71d73a72820c029a8f1280ad8f91d7f5b430d906c1a272ef">MIDIReadEvent::SYSEX_MESSAGE</a></div><div class="ttdeci">@ SYSEX_MESSAGE</div><div class="ttdoc">A MIDI System Exclusive message was received.</div></div>
<div class="ttc" id="aMIDIReadEvent_8hpp_html_a16d614a4b221d351c71d73a72820c029a8f3bdd6b6cc8ea9bc4be3a5783055d20"><div class="ttname"><a href="../../d1/d70/MIDIReadEvent_8hpp.html#a16d614a4b221d351c71d73a72820c029a8f3bdd6b6cc8ea9bc4be3a5783055d20">MIDIReadEvent::REALTIME_MESSAGE</a></div><div class="ttdeci">@ REALTIME_MESSAGE</div><div class="ttdoc">A MIDI Real-Time message was received.</div></div>
<div class="ttc" id="aSettings_2NamespaceSettings_8hpp_html_a9305dd4bad1398506431b42a5a100f8d"><div class="ttname"><a href="../../d0/da7/Settings_2NamespaceSettings_8hpp.html#a9305dd4bad1398506431b42a5a100f8d">END_CS_NAMESPACE</a></div><div class="ttdeci">#define END_CS_NAMESPACE</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da7/Settings_2NamespaceSettings_8hpp_source.html#l00010">Settings/NamespaceSettings.hpp:10</a></div></div>
<div class="ttc" id="aSettings_2NamespaceSettings_8hpp_html_a9432e3744c64fcf8e711ef91eff6a5cd"><div class="ttname"><a href="../../d0/da7/Settings_2NamespaceSettings_8hpp.html#a9432e3744c64fcf8e711ef91eff6a5cd">BEGIN_CS_NAMESPACE</a></div><div class="ttdeci">#define BEGIN_CS_NAMESPACE</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da7/Settings_2NamespaceSettings_8hpp_source.html#l00009">Settings/NamespaceSettings.hpp:9</a></div></div>
<div class="ttc" id="aclassBLEMIDIPacketBuilder_html_a2935e02624493a655bf6933d816202a1"><div class="ttname"><a href="../../d7/d8e/classBLEMIDIPacketBuilder.html#a2935e02624493a655bf6933d816202a1">BLEMIDIPacketBuilder::getSize</a></div><div class="ttdeci">uint16_t getSize() const</div><div class="ttdoc">Get the size of the current packet.</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d21/BLEMIDIPacketBuilder_8hpp_source.html#l00079">BLEMIDIPacketBuilder.hpp:79</a></div></div>
<div class="ttc" id="aclassBLEMIDIPacketBuilder_html_a2a81283fcd3295bbfb1a6b332e9fc593"><div class="ttname"><a href="../../d7/d8e/classBLEMIDIPacketBuilder.html#a2a81283fcd3295bbfb1a6b332e9fc593">BLEMIDIPacketBuilder::setCapacity</a></div><div class="ttdeci">void setCapacity(uint16_t capacity)</div><div class="ttdoc">Set the maximum capacity of the buffer.</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d48/BLEMIDIPacketBuilder_8cpp_source.html#l00053">BLEMIDIPacketBuilder.cpp:53</a></div></div>
<div class="ttc" id="aclassBLEMIDIPacketBuilder_html_a2c7ed84a517b162234e17b06b11b66a1"><div class="ttname"><a href="../../d7/d8e/classBLEMIDIPacketBuilder.html#a2c7ed84a517b162234e17b06b11b66a1">BLEMIDIPacketBuilder::continueSysEx</a></div><div class="ttdeci">void continueSysEx(const uint8_t *&amp;data, size_t &amp;length, uint16_t timestamp)</div><div class="ttdoc">Add a SysEx continuation to the packet.</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d48/BLEMIDIPacketBuilder_8cpp_source.html#l00117">BLEMIDIPacketBuilder.cpp:117</a></div></div>
<div class="ttc" id="aclassBLEMIDIPacketBuilder_html_a4355f549204eea18fdd652378fa92243"><div class="ttname"><a href="../../d7/d8e/classBLEMIDIPacketBuilder.html#a4355f549204eea18fdd652378fa92243">BLEMIDIPacketBuilder::addSysEx</a></div><div class="ttdeci">bool addSysEx(const uint8_t *&amp;data, size_t &amp;length, uint16_t timestamp)</div><div class="ttdoc">Try adding (part of) a SysEx message to the packet.</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d48/BLEMIDIPacketBuilder_8cpp_source.html#l00085">BLEMIDIPacketBuilder.cpp:85</a></div></div>
<div class="ttc" id="aclassBLEMIDIPacketBuilder_html_a644718bb2fb240de962dc3c9a1fdf0dc"><div class="ttname"><a href="../../d7/d8e/classBLEMIDIPacketBuilder.html#a644718bb2fb240de962dc3c9a1fdf0dc">BLEMIDIPacketBuilder::empty</a></div><div class="ttdeci">bool empty() const</div><div class="ttdoc">Check if the packet buffer is empty.</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d21/BLEMIDIPacketBuilder_8hpp_source.html#l00083">BLEMIDIPacketBuilder.hpp:83</a></div></div>
<div class="ttc" id="aclassBLEMIDIPacketBuilder_html_a72e819256a3236668ca21796feebdb70"><div class="ttname"><a href="../../d7/d8e/classBLEMIDIPacketBuilder.html#a72e819256a3236668ca21796feebdb70">BLEMIDIPacketBuilder::add2B</a></div><div class="ttdeci">bool add2B(uint8_t header, uint8_t data1, uint16_t timestamp)</div><div class="ttdoc">Try adding a 2-byte MIDI channel voice message to the packet.</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d48/BLEMIDIPacketBuilder_8cpp_source.html#l00066">BLEMIDIPacketBuilder.cpp:66</a></div></div>
<div class="ttc" id="aclassBLEMIDIPacketBuilder_html_aa66e5a45f2dbd33f6803a1dbbe4882ba"><div class="ttname"><a href="../../d7/d8e/classBLEMIDIPacketBuilder.html#aa66e5a45f2dbd33f6803a1dbbe4882ba">BLEMIDIPacketBuilder::addRealTime</a></div><div class="ttdeci">bool addRealTime(uint8_t rt, uint16_t timestamp)</div><div class="ttdoc">Try adding a MIDI real-time message to the packet.</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d48/BLEMIDIPacketBuilder_8cpp_source.html#l00072">BLEMIDIPacketBuilder.cpp:72</a></div></div>
<div class="ttc" id="aclassBLEMIDIPacketBuilder_html_ad20897c5c8bd47f5d4005989bead0e55"><div class="ttname"><a href="../../d7/d8e/classBLEMIDIPacketBuilder.html#ad20897c5c8bd47f5d4005989bead0e55">BLEMIDIPacketBuilder::reset</a></div><div class="ttdeci">void reset()</div><div class="ttdoc">Reset the builder to start a new packet.</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d48/BLEMIDIPacketBuilder_8cpp_source.html#l00048">BLEMIDIPacketBuilder.cpp:48</a></div></div>
<div class="ttc" id="aclassBLEMIDIPacketBuilder_html_ada92d3f6590c15d194a997ace44a577b"><div class="ttname"><a href="../../d7/d8e/classBLEMIDIPacketBuilder.html#ada92d3f6590c15d194a997ace44a577b">BLEMIDIPacketBuilder::getPacket</a></div><div class="ttdeci">const std::vector&lt; uint8_t &gt; &amp; getPacket() const</div><div class="ttdoc">Return the packet as a vector of bytes.</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d21/BLEMIDIPacketBuilder_8hpp_source.html#l00086">BLEMIDIPacketBuilder.hpp:86</a></div></div>
<div class="ttc" id="aclassBLEMIDIPacketBuilder_html_aeea6539b85771e065d9b2a20265671b9"><div class="ttname"><a href="../../d7/d8e/classBLEMIDIPacketBuilder.html#aeea6539b85771e065d9b2a20265671b9">BLEMIDIPacketBuilder::add3B</a></div><div class="ttdeci">bool add3B(uint8_t header, uint8_t data1, uint8_t data2, uint16_t timestamp)</div><div class="ttdoc">Try adding a 3-byte MIDI channel voice message to the packet.</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d48/BLEMIDIPacketBuilder_8cpp_source.html#l00060">BLEMIDIPacketBuilder.cpp:60</a></div></div>
<div class="ttc" id="aclassBLEMIDIParser_html"><div class="ttname"><a href="../../d9/d19/classBLEMIDIParser.html">BLEMIDIParser</a></div><div class="ttdoc">Class for parsing BLE-MIDI packets.</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d66/BLEMIDIParser_8hpp_source.html#l00016">BLEMIDIParser.hpp:16</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html">BluetoothMIDI_Interface</a></div><div class="ttdoc">Bluetooth Low Energy MIDI Interface for the ESP32.</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/BluetoothMIDI__Interface_8hpp_source.html#l00029">BluetoothMIDI_Interface.hpp:29</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html_a04c9d2d0564e73d40705476583ec8faa"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html#a04c9d2d0564e73d40705476583ec8faa">BluetoothMIDI_Interface::getChannelMessage</a></div><div class="ttdeci">ChannelMessage getChannelMessage() const</div><div class="ttdoc">Return the received channel voice message.</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d2c/BluetoothMIDI__Interface_8cpp_source.html#l00213">BluetoothMIDI_Interface.cpp:213</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html_a0655ff0c22f4e0d024e9b3aad75e51d1"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html#a0655ff0c22f4e0d024e9b3aad75e51d1">BluetoothMIDI_Interface::getRealTimeMessage</a></div><div class="ttdeci">RealTimeMessage getRealTimeMessage() const</div><div class="ttdoc">Return the received real-time message.</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d2c/BluetoothMIDI__Interface_8cpp_source.html#l00225">BluetoothMIDI_Interface.cpp:225</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html_a0afa02d14fff34c480aabfbc41ad193c"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html#a0afa02d14fff34c480aabfbc41ad193c">BluetoothMIDI_Interface::cv</a></div><div class="ttdeci">std::condition_variable cv</div><div class="ttdoc">Condition variable used by the background sender thread to wait for data to send, and for the main th...</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/BluetoothMIDI__Interface_8hpp_source.html#l00137">BluetoothMIDI_Interface.hpp:137</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html_a1bf98c5cdd61db16f9ec0c30881d6588"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html#a1bf98c5cdd61db16f9ec0c30881d6588">BluetoothMIDI_Interface::lock_t</a></div><div class="ttdeci">std::unique_lock&lt; std::mutex &gt; lock_t</div><div class="ttdoc">Lock type used to lock the mutex.</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/BluetoothMIDI__Interface_8hpp_source.html#l00131">BluetoothMIDI_Interface.hpp:131</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html_a26727d2ea528cebfed726e19997ecadc"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html#a26727d2ea528cebfed726e19997ecadc">BluetoothMIDI_Interface::timeout</a></div><div class="ttdeci">std::chrono::milliseconds timeout</div><div class="ttdoc">Timeout before the sender thread sends a packet.</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/BluetoothMIDI__Interface_8hpp_source.html#l00146">BluetoothMIDI_Interface.hpp:146</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html_a2a4f9d46c675709ce37c03869740ce01"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html#a2a4f9d46c675709ce37c03869740ce01">BluetoothMIDI_Interface::incomingMessage</a></div><div class="ttdeci">MIDIMessageQueue::MIDIMessageQueueElement incomingMessage</div><div class="ttdoc">Incoming message that can be from retrieved using the getChannelMessage(), getSysCommonMessage(),...</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/BluetoothMIDI__Interface_8hpp_source.html#l00125">BluetoothMIDI_Interface.hpp:125</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html_a31108ad1565c1ab32797d1574343b2df"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html#a31108ad1565c1ab32797d1574343b2df">BluetoothMIDI_Interface::sendChannelMessageImpl</a></div><div class="ttdeci">void sendChannelMessageImpl(ChannelMessage) override</div><div class="ttdoc">Low-level function for sending a MIDI channel voice message.</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d2c/BluetoothMIDI__Interface_8cpp_source.html#l00093">BluetoothMIDI_Interface.cpp:93</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html_a3c3a2d56c1a465c8f8356d6e40c7ad61"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html#a3c3a2d56c1a465c8f8356d6e40c7ad61">BluetoothMIDI_Interface::parse</a></div><div class="ttdeci">void parse(const uint8_t *const data, const size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d2c/BluetoothMIDI__Interface_8cpp_source.html#l00174">BluetoothMIDI_Interface.cpp:174</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html_a3e2e81eeb421a671b7444665f87a1068"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html#a3e2e81eeb421a671b7444665f87a1068">BluetoothMIDI_Interface::forceMinMTU</a></div><div class="ttdeci">void forceMinMTU(uint16_t mtu)</div><div class="ttdoc">Force the MTU to an artificially small value (used for testing).</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d2c/BluetoothMIDI__Interface_8cpp_source.html#l00253">BluetoothMIDI_Interface.cpp:253</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html_a5fd9976d3d7ba5d9658abf107ea3003a"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html#a5fd9976d3d7ba5d9658abf107ea3003a">BluetoothMIDI_Interface::instance</a></div><div class="ttdeci">static BluetoothMIDI_Interface * instance</div><div class="ttdoc">Only one active instance.</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/BluetoothMIDI__Interface_8hpp_source.html#l00115">BluetoothMIDI_Interface.hpp:115</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html_a619f40e8b17dcb767df39bedc878ab50"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html#a619f40e8b17dcb767df39bedc878ab50">BluetoothMIDI_Interface::getSysCommonMessage</a></div><div class="ttdeci">SysCommonMessage getSysCommonMessage() const</div><div class="ttdoc">Return the received system common message.</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d2c/BluetoothMIDI__Interface_8cpp_source.html#l00219">BluetoothMIDI_Interface.cpp:219</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html_a621e44a535a138a59ffd3681dab224b6"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html#a621e44a535a138a59ffd3681dab224b6">BluetoothMIDI_Interface::sendRealTimeImpl</a></div><div class="ttdeci">void sendRealTimeImpl(RealTimeMessage) override</div><div class="ttdoc">Low-level function for sending a MIDI real-time message.</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d2c/BluetoothMIDI__Interface_8cpp_source.html#l00129">BluetoothMIDI_Interface.cpp:129</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html_a65e5fa6951d8a96b57efbb0d8faf8fee"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html#a65e5fa6951d8a96b57efbb0d8faf8fee">BluetoothMIDI_Interface::force_min_mtu</a></div><div class="ttdeci">std::atomic_uint_fast16_t force_min_mtu</div><div class="ttdoc">Override the minimum MTU (0 means don't override, nonzero overrides if it's smaller than the minimum ...</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/BluetoothMIDI__Interface_8hpp_source.html#l00100">BluetoothMIDI_Interface.hpp:100</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html_a774b1cce4553aa2fe13aa42cc1cad3a1"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html#a774b1cce4553aa2fe13aa42cc1cad3a1">BluetoothMIDI_Interface::flushImpl</a></div><div class="ttdeci">void flushImpl(lock_t &amp;lock)</div><div class="ttdoc">Tell the background BLE sender thread to send the current packet.</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d2c/BluetoothMIDI__Interface_8cpp_source.html#l00048">BluetoothMIDI_Interface.cpp:48</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html_a7c3e14d99bd3dc0e3670d6956dafcaf2"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html#a7c3e14d99bd3dc0e3670d6956dafcaf2">BluetoothMIDI_Interface::begin</a></div><div class="ttdeci">void begin() override</div><div class="ttdoc">Initialize this updatable.</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d2c/BluetoothMIDI__Interface_8cpp_source.html#l00271">BluetoothMIDI_Interface.cpp:271</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html_a81d8a08704c47d15c13785ce81719517"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html#a81d8a08704c47d15c13785ce81719517">BluetoothMIDI_Interface::packetbuilder</a></div><div class="ttdeci">BLEMIDIPacketBuilder packetbuilder</div><div class="ttdoc">Builds outgoing MIDI BLE packets.</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/BluetoothMIDI__Interface_8hpp_source.html#l00119">BluetoothMIDI_Interface.hpp:119</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html_a8440b5741ad49bee352994b5502382ad"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html#a8440b5741ad49bee352994b5502382ad">BluetoothMIDI_Interface::queue</a></div><div class="ttdeci">MIDIMessageQueue queue</div><div class="ttdoc">Queue for incoming MIDI messages.</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/BluetoothMIDI__Interface_8hpp_source.html#l00121">BluetoothMIDI_Interface.hpp:121</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html_a85e6e468294dc1ac2fa67323aca1bed5"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html#a85e6e468294dc1ac2fa67323aca1bed5">BluetoothMIDI_Interface::sendChannelMessageImpl2Bytes</a></div><div class="ttdeci">void sendChannelMessageImpl2Bytes(ChannelMessage)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d2c/BluetoothMIDI__Interface_8cpp_source.html#l00116">BluetoothMIDI_Interface.cpp:116</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html_a87bc660c1a9bd50443efdf7037e68b13"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html#a87bc660c1a9bd50443efdf7037e68b13">BluetoothMIDI_Interface::stopSendingThread</a></div><div class="ttdeci">void stopSendingThread()</div><div class="ttdoc">Tell the background BLE sender thread to stop gracefully, and join it.</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d2c/BluetoothMIDI__Interface_8cpp_source.html#l00065">BluetoothMIDI_Interface.cpp:65</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html_a956d5768bb3ec516505f447ca3062f81"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html#a956d5768bb3ec516505f447ca3062f81">BluetoothMIDI_Interface::sendSysExImpl</a></div><div class="ttdeci">void sendSysExImpl(SysExMessage) override</div><div class="ttdoc">Low-level function for sending a system exclusive MIDI message.</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d2c/BluetoothMIDI__Interface_8cpp_source.html#l00142">BluetoothMIDI_Interface.cpp:142</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html_a9bc7ba36e0b11965a1db3594c6e59261"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html#a9bc7ba36e0b11965a1db3594c6e59261">BluetoothMIDI_Interface::midi_mtu_callback</a></div><div class="ttdeci">static void midi_mtu_callback(uint16_t mtu)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/BluetoothMIDI__Interface_8hpp_source.html#l00174">BluetoothMIDI_Interface.hpp:174</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html_aa6576f35a669d710636e2242432a1130"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html#aa6576f35a669d710636e2242432a1130">BluetoothMIDI_Interface::startSendingThread</a></div><div class="ttdeci">void startSendingThread()</div><div class="ttdoc">Launch a thread that sends the BLE packets in the background.</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d2c/BluetoothMIDI__Interface_8cpp_source.html#l00013">BluetoothMIDI_Interface.cpp:13</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html_aa69dcb3b0685c862bcf4698b5ea3a13c"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html#aa69dcb3b0685c862bcf4698b5ea3a13c">BluetoothMIDI_Interface::sendChannelMessageImpl3Bytes</a></div><div class="ttdeci">void sendChannelMessageImpl3Bytes(ChannelMessage)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d2c/BluetoothMIDI__Interface_8cpp_source.html#l00098">BluetoothMIDI_Interface.cpp:98</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html_aaf81d3fdaf258088d7692fa70cece087"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html#aaf81d3fdaf258088d7692fa70cece087">BluetoothMIDI_Interface::end</a></div><div class="ttdeci">void end()</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d2c/BluetoothMIDI__Interface_8cpp_source.html#l00284">BluetoothMIDI_Interface.cpp:284</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html_ab6987415b7f83920cd43f1f34dd593ae"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html#ab6987415b7f83920cd43f1f34dd593ae">BluetoothMIDI_Interface::handleSendEvents</a></div><div class="ttdeci">void handleSendEvents()</div><div class="ttdoc">Function that waits for BLE packets and sends them in the background.</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d2c/BluetoothMIDI__Interface_8cpp_source.html#l00025">BluetoothMIDI_Interface.cpp:25</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html_ab9f84ac84f5789dc55463c2284486be2"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html#ab9f84ac84f5789dc55463c2284486be2">BluetoothMIDI_Interface::flushnow</a></div><div class="ttdeci">bool flushnow</div><div class="ttdoc">Flag to tell the sender thread to send the packet immediately.</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/BluetoothMIDI__Interface_8hpp_source.html#l00143">BluetoothMIDI_Interface.hpp:143</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html_ac0b97c3d43e512fc8118c01b655f2636"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html#ac0b97c3d43e512fc8118c01b655f2636">BluetoothMIDI_Interface::send_thread</a></div><div class="ttdeci">std::thread send_thread</div><div class="ttdoc">Background thread that sends the actual MIDI BLE packets.</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/BluetoothMIDI__Interface_8hpp_source.html#l00139">BluetoothMIDI_Interface.hpp:139</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html_acb0235e1dec5da5120871d207b87586b"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html#acb0235e1dec5da5120871d207b87586b">BluetoothMIDI_Interface::notifyMIDIBLE</a></div><div class="ttdeci">void notifyMIDIBLE(const std::vector&lt; uint8_t &gt; &amp;packet)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d2c/BluetoothMIDI__Interface_8cpp_source.html#l00083">BluetoothMIDI_Interface.cpp:83</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html_ad5e0dbd36f0d71fce9b00b7f991b2f38"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html#ad5e0dbd36f0d71fce9b00b7f991b2f38">BluetoothMIDI_Interface::mtx</a></div><div class="ttdeci">std::mutex mtx</div><div class="ttdoc">Mutex to lock the MIDI BLE packet builder and the flush flag.</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/BluetoothMIDI__Interface_8hpp_source.html#l00133">BluetoothMIDI_Interface.hpp:133</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html_adb02fa6b9ddb7404758bcad36115a26e"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html#adb02fa6b9ddb7404758bcad36115a26e">BluetoothMIDI_Interface::read</a></div><div class="ttdeci">MIDIReadEvent read()</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d2c/BluetoothMIDI__Interface_8cpp_source.html#l00206">BluetoothMIDI_Interface.cpp:206</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html_adb225c79278fe437cdbcef7569e7e3fc"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html#adb225c79278fe437cdbcef7569e7e3fc">BluetoothMIDI_Interface::updateMTU</a></div><div class="ttdeci">void updateMTU(uint16_t mtu)</div><div class="ttdoc">Set the maximum transmission unit of the Bluetooth link.</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d2c/BluetoothMIDI__Interface_8cpp_source.html#l00241">BluetoothMIDI_Interface.cpp:241</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html_ae0090fc21e6e632fc4510f57e29b5dea"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html#ae0090fc21e6e632fc4510f57e29b5dea">BluetoothMIDI_Interface::stop_sending</a></div><div class="ttdeci">std::atomic_bool stop_sending</div><div class="ttdoc">Flag to stop the background thread.</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/BluetoothMIDI__Interface_8hpp_source.html#l00141">BluetoothMIDI_Interface.hpp:141</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html_ae3a623951f55462fb1a5925252ac1c55"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html#ae3a623951f55462fb1a5925252ac1c55">BluetoothMIDI_Interface::getSysExMessage</a></div><div class="ttdeci">SysExMessage getSysExMessage() const</div><div class="ttdoc">Return the received system exclusive message.</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d2c/BluetoothMIDI__Interface_8cpp_source.html#l00231">BluetoothMIDI_Interface.cpp:231</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html_af9132080b7be05255873ea3c133c2748"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html#af9132080b7be05255873ea3c133c2748">BluetoothMIDI_Interface::min_mtu</a></div><div class="ttdeci">std::atomic_uint_fast16_t min_mtu</div><div class="ttdoc">The minimum MTU of all connected clients.</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/BluetoothMIDI__Interface_8hpp_source.html#l00096">BluetoothMIDI_Interface.hpp:96</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html_afcb1a2d039abd7b9058d2d224936a901"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html#afcb1a2d039abd7b9058d2d224936a901">BluetoothMIDI_Interface::parser</a></div><div class="ttdeci">SerialMIDI_Parser parser</div><div class="ttdoc">MIDI Parser for incoming data.</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/BluetoothMIDI__Interface_8hpp_source.html#l00117">BluetoothMIDI_Interface.hpp:117</a></div></div>
<div class="ttc" id="aclassBluetoothMIDI__Interface_html_affc217586537ff5c090cd97874c16175"><div class="ttname"><a href="../../d0/d89/classBluetoothMIDI__Interface.html#affc217586537ff5c090cd97874c16175">BluetoothMIDI_Interface::midi_write_callback</a></div><div class="ttdeci">static void midi_write_callback(const uint8_t *data, size_t length)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/BluetoothMIDI__Interface_8hpp_source.html#l00169">BluetoothMIDI_Interface.hpp:169</a></div></div>
<div class="ttc" id="aclassMIDIMessageQueue_html_ad163f033645fb890e0b314dd4ec14302"><div class="ttname"><a href="../../d6/d71/classMIDIMessageQueue.html#ad163f033645fb890e0b314dd4ec14302">MIDIMessageQueue::pop</a></div><div class="ttdeci">bool pop(MIDIMessageQueueElement &amp;message)</div></div>
<div class="ttc" id="aclassMIDIMessageQueue_html_afc9078484775fa28a47f1c5529b36cc6"><div class="ttname"><a href="../../d6/d71/classMIDIMessageQueue.html#afc9078484775fa28a47f1c5529b36cc6">MIDIMessageQueue::push</a></div><div class="ttdeci">bool push(ChannelMessage message)</div></div>
<div class="ttc" id="aclassMIDI__Parser_html_a04c9d2d0564e73d40705476583ec8faa"><div class="ttname"><a href="../../df/d0c/classMIDI__Parser.html#a04c9d2d0564e73d40705476583ec8faa">MIDI_Parser::getChannelMessage</a></div><div class="ttdeci">ChannelMessage getChannelMessage() const</div><div class="ttdoc">Get the latest MIDI channel voice message.</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d2d/MIDI__Parser_8hpp_source.html#l00019">MIDI_Parser.hpp:19</a></div></div>
<div class="ttc" id="aclassMIDI__Parser_html_a0655ff0c22f4e0d024e9b3aad75e51d1"><div class="ttname"><a href="../../df/d0c/classMIDI__Parser.html#a0655ff0c22f4e0d024e9b3aad75e51d1">MIDI_Parser::getRealTimeMessage</a></div><div class="ttdeci">RealTimeMessage getRealTimeMessage() const</div><div class="ttdoc">Get the latest MIDI real-time message.</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d2d/MIDI__Parser_8hpp_source.html#l00025">MIDI_Parser.hpp:25</a></div></div>
<div class="ttc" id="aclassMIDI__Parser_html_a619f40e8b17dcb767df39bedc878ab50"><div class="ttname"><a href="../../df/d0c/classMIDI__Parser.html#a619f40e8b17dcb767df39bedc878ab50">MIDI_Parser::getSysCommonMessage</a></div><div class="ttdeci">SysCommonMessage getSysCommonMessage() const</div><div class="ttdoc">Get the latest MIDI system common message.</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d2d/MIDI__Parser_8hpp_source.html#l00021">MIDI_Parser.hpp:21</a></div></div>
<div class="ttc" id="aclassSerialMIDI__Parser_html_a9b4887f4c5b19d9b45134558804d3659"><div class="ttname"><a href="../../d0/d0d/classSerialMIDI__Parser.html#a9b4887f4c5b19d9b45134558804d3659">SerialMIDI_Parser::pull</a></div><div class="ttdeci">MIDIReadEvent pull(BytePuller &amp;&amp;puller)</div><div class="ttdoc">Parse one incoming MIDI message.</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d22/SerialMIDI__Parser_8hpp_source.html#l00079">SerialMIDI_Parser.hpp:79</a></div></div>
<div class="ttc" id="aclassSerialMIDI__Parser_html_ae3a623951f55462fb1a5925252ac1c55"><div class="ttname"><a href="../../d0/d0d/classSerialMIDI__Parser.html#ae3a623951f55462fb1a5925252ac1c55">SerialMIDI_Parser::getSysExMessage</a></div><div class="ttdeci">SysExMessage getSysExMessage() const</div><div class="ttdoc">Get the latest SysEx message.</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d22/SerialMIDI__Parser_8hpp_source.html#l00035">SerialMIDI_Parser.hpp:35</a></div></div>
<div class="ttc" id="agroup__AH__Debug_html_ga35654913b4a1f9d9300f847fab14b3d3"><div class="ttname"><a href="../../d4/da5/group__AH__Debug.html#ga35654913b4a1f9d9300f847fab14b3d3">NAMEDVALUE</a></div><div class="ttdeci">#define NAMEDVALUE(x)</div><div class="ttdoc">Macro for printing an expression as a string, followed by its value.</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dee/Debug_8hpp_source.html#l00084">Debug.hpp:84</a></div></div>
<div class="ttc" id="agroup__AH__Debug_html_ga5e1b7520df0706433ae295a78471fb3c"><div class="ttname"><a href="../../d4/da5/group__AH__Debug.html#ga5e1b7520df0706433ae295a78471fb3c">DEBUGFN</a></div><div class="ttdeci">#define DEBUGFN(x)</div><div class="ttdoc">Print an expression and its function (function name and line number) to the debug output if debugging...</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dee/Debug_8hpp_source.html#l00110">Debug.hpp:110</a></div></div>
<div class="ttc" id="agroup__AH__Error_html_ga7eae7037bf6cdc6bf5d46a11572194db"><div class="ttname"><a href="../../d0/df7/group__AH__Error.html#ga7eae7037bf6cdc6bf5d46a11572194db">ERROR</a></div><div class="ttdeci">#define ERROR(msg, errc)</div><div class="ttdoc">Print the error message and error code, and stop the execution if FATAL_ERRORS are enabled.</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d93/Error_8hpp_source.html#l00042">Error.hpp:42</a></div></div>
<div class="ttc" id="agroup__AH__Math_html_ga5e07739c1fd7a29e6b2840237af7f1bc"><div class="ttname"><a href="../../dd/d5e/group__AH__Math.html#ga5e07739c1fd7a29e6b2840237af7f1bc">AH::min</a></div><div class="ttdeci">constexpr auto min(const T &amp;a, const U &amp;b) -&gt; decltype(b&lt; a ? b :a)</div><div class="ttdoc">Return the smaller of two numbers/objects.</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d79/MinMaxFix_8hpp_source.html#l00015">MinMaxFix.hpp:15</a></div></div>
<div class="ttc" id="amidi_8h_html"><div class="ttname"><a href="../../dc/dc7/midi_8h.html">midi.h</a></div><div class="ttdoc">Public MIDI over Bluetooth Low Energy API.</div></div>
<div class="ttc" id="amidi_8h_html_a25cd3ab0c944e5cb12316b79cb1e3566"><div class="ttname"><a href="../../dc/dc7/midi_8h.html#a25cd3ab0c944e5cb12316b79cb1e3566">midi_deinit</a></div><div class="ttdeci">bool midi_deinit()</div><div class="ttdoc">Cleanup the MIDI BLE application and de-initialize the Bluetooth stack.</div></div>
<div class="ttc" id="amidi_8h_html_a57981a470092a596f6e0058b9b8e0aa5"><div class="ttname"><a href="../../dc/dc7/midi_8h.html#a57981a470092a596f6e0058b9b8e0aa5">midi_init</a></div><div class="ttdeci">bool midi_init()</div><div class="ttdoc">Initialize the Bluetooth stack and register the MIDI BLE application with the Bluedroid driver.</div></div>
<div class="ttc" id="amidi_8h_html_a87000ead29f63a1b923aab803bdb775f"><div class="ttname"><a href="../../dc/dc7/midi_8h.html#a87000ead29f63a1b923aab803bdb775f">midi_set_write_callback</a></div><div class="ttdeci">void midi_set_write_callback(midi_write_callback_t cb)</div><div class="ttdoc">Set the callback that is to be called when the client writes (sends) a MIDI packet.</div></div>
<div class="ttc" id="amidi_8h_html_a9d22b3d6becc73fe2ed32e563cdae100"><div class="ttname"><a href="../../dc/dc7/midi_8h.html#a9d22b3d6becc73fe2ed32e563cdae100">midi_set_mtu_callback</a></div><div class="ttdeci">void midi_set_mtu_callback(midi_mtu_callback_t cb)</div><div class="ttdoc">Set the callback that is to be called when the MTU negotiation with the BLE client is finished.</div></div>
<div class="ttc" id="amidi_8h_html_aa600e500c302f6dfa01b183e0ef865c6"><div class="ttname"><a href="../../dc/dc7/midi_8h.html#aa600e500c302f6dfa01b183e0ef865c6">midi_notify</a></div><div class="ttdeci">bool midi_notify(const uint8_t *data, size_t len)</div><div class="ttdoc">Send a MIDI BLE notification to the client.</div></div>
<div class="ttc" id="anamespaceMIDI__Notes_html_a782ecf472467d5b568ea62a533489807"><div class="ttname"><a href="../../d7/d78/namespaceMIDI__Notes.html#a782ecf472467d5b568ea62a533489807">MIDI_Notes::F</a></div><div class="ttdeci">constexpr int8_t F</div><div class="ttdoc">F (Fa)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dc5/Notes_8hpp_source.html#l00021">Notes.hpp:21</a></div></div>
<div class="ttc" id="astructChannelMessage_html"><div class="ttname"><a href="../../d7/d3f/structChannelMessage.html">ChannelMessage</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d40/MIDI__MessageTypes_8hpp_source.html#l00168">MIDI_MessageTypes.hpp:168</a></div></div>
<div class="ttc" id="astructChannelMessage_html_afd23dd74db590cb5061ccc90da4d2291"><div class="ttname"><a href="../../d7/d3f/structChannelMessage.html#afd23dd74db590cb5061ccc90da4d2291">ChannelMessage::hasTwoDataBytes</a></div><div class="ttdeci">bool hasTwoDataBytes() const</div><div class="ttdoc">Check whether this message has one or two data bytes.</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d40/MIDI__MessageTypes_8hpp_source.html#l00211">MIDI_MessageTypes.hpp:211</a></div></div>
<div class="ttc" id="astructMIDIMessageQueue_1_1MIDIMessageQueueElement_html_a108a96f1654fb7609ad870e9bbdc6470"><div class="ttname"><a href="../../d9/d4b/structMIDIMessageQueue_1_1MIDIMessageQueueElement.html#a108a96f1654fb7609ad870e9bbdc6470">MIDIMessageQueue::MIDIMessageQueueElement::eventType</a></div><div class="ttdeci">MIDIReadEvent eventType</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d52/MIDIMessageQueue_8hpp_source.html#l00015">MIDIMessageQueue.hpp:15</a></div></div>
<div class="ttc" id="astructMIDIMessageQueue_1_1MIDIMessageQueueElement_html_a305d0016a932f263f616fd5df16ab382"><div class="ttname"><a href="../../d9/d4b/structMIDIMessageQueue_1_1MIDIMessageQueueElement.html#a305d0016a932f263f616fd5df16ab382">MIDIMessageQueue::MIDIMessageQueueElement::message</a></div><div class="ttdeci">union MIDIMessageQueue::MIDIMessageQueueElement::Message message</div></div>
<div class="ttc" id="astructMIDIMessage_html_a147e14d13d9459cedff4ee049f231abf"><div class="ttname"><a href="../../d4/d61/structMIDIMessage.html#a147e14d13d9459cedff4ee049f231abf">MIDIMessage::data2</a></div><div class="ttdeci">uint8_t data2</div><div class="ttdoc">First MIDI data byte.</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d40/MIDI__MessageTypes_8hpp_source.html#l00097">MIDI_MessageTypes.hpp:97</a></div></div>
<div class="ttc" id="astructMIDIMessage_html_a3707517cb22eb26bf33bbb859fb010d2"><div class="ttname"><a href="../../d4/d61/structMIDIMessage.html#a3707517cb22eb26bf33bbb859fb010d2">MIDIMessage::header</a></div><div class="ttdeci">uint8_t header</div><div class="ttdoc">MIDI status byte (message type and channel).</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d40/MIDI__MessageTypes_8hpp_source.html#l00095">MIDI_MessageTypes.hpp:95</a></div></div>
<div class="ttc" id="astructMIDIMessage_html_a834ae4387b1eb95fa926d466f254e468"><div class="ttname"><a href="../../d4/d61/structMIDIMessage.html#a834ae4387b1eb95fa926d466f254e468">MIDIMessage::data1</a></div><div class="ttdeci">uint8_t data1</div><div class="ttdoc">First MIDI data byte.</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d40/MIDI__MessageTypes_8hpp_source.html#l00096">MIDI_MessageTypes.hpp:96</a></div></div>
<div class="ttc" id="astructRealTimeMessage_html"><div class="ttname"><a href="../../d6/d99/structRealTimeMessage.html">RealTimeMessage</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d40/MIDI__MessageTypes_8hpp_source.html#l00290">MIDI_MessageTypes.hpp:290</a></div></div>
<div class="ttc" id="astructRealTimeMessage_html_a70458cf1b28859e94ae35dfe6df1a497"><div class="ttname"><a href="../../d6/d99/structRealTimeMessage.html#a70458cf1b28859e94ae35dfe6df1a497">RealTimeMessage::message</a></div><div class="ttdeci">uint8_t message</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d40/MIDI__MessageTypes_8hpp_source.html#l00299">MIDI_MessageTypes.hpp:299</a></div></div>
<div class="ttc" id="astructScopedThreadConfig_html"><div class="ttname"><a href="../../de/d27/structScopedThreadConfig.html">ScopedThreadConfig</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d31/ESP32Threads_8hpp_source.html#l00011">ESP32Threads.hpp:11</a></div></div>
<div class="ttc" id="astructSysCommonMessage_html"><div class="ttname"><a href="../../d5/dad/structSysCommonMessage.html">SysCommonMessage</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d40/MIDI__MessageTypes_8hpp_source.html#l00218">MIDI_MessageTypes.hpp:218</a></div></div>
<div class="ttc" id="astructSysExMessage_html"><div class="ttname"><a href="../../db/d45/structSysExMessage.html">SysExMessage</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d40/MIDI__MessageTypes_8hpp_source.html#l00244">MIDI_MessageTypes.hpp:244</a></div></div>
<div class="ttc" id="astructSysExMessage_html_a1892eba2086d12ac2b09005aeb09ea3b"><div class="ttname"><a href="../../db/d45/structSysExMessage.html#a1892eba2086d12ac2b09005aeb09ea3b">SysExMessage::length</a></div><div class="ttdeci">uint16_t length</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d40/MIDI__MessageTypes_8hpp_source.html#l00262">MIDI_MessageTypes.hpp:262</a></div></div>
<div class="ttc" id="astructSysExMessage_html_a579f5164b5b16e18ddcdb0296ef81799"><div class="ttname"><a href="../../db/d45/structSysExMessage.html#a579f5164b5b16e18ddcdb0296ef81799">SysExMessage::data</a></div><div class="ttdeci">const uint8_t * data</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d40/MIDI__MessageTypes_8hpp_source.html#l00261">MIDI_MessageTypes.hpp:261</a></div></div>
<div class="ttc" id="aunionMIDIMessageQueue_1_1MIDIMessageQueueElement_1_1Message_html_a60a0af53c10ec0c1174ae9e9ec51facd"><div class="ttname"><a href="../../db/d98/unionMIDIMessageQueue_1_1MIDIMessageQueueElement_1_1Message.html#a60a0af53c10ec0c1174ae9e9ec51facd">MIDIMessageQueue::MIDIMessageQueueElement::Message::channelmessage</a></div><div class="ttdeci">ChannelMessage channelmessage</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d52/MIDIMessageQueue_8hpp_source.html#l00017">MIDIMessageQueue.hpp:17</a></div></div>
<div class="ttc" id="aunionMIDIMessageQueue_1_1MIDIMessageQueueElement_1_1Message_html_a8bced99b947fdc61bdbd02a1fdd55c7a"><div class="ttname"><a href="../../db/d98/unionMIDIMessageQueue_1_1MIDIMessageQueueElement_1_1Message.html#a8bced99b947fdc61bdbd02a1fdd55c7a">MIDIMessageQueue::MIDIMessageQueueElement::Message::realtimemessage</a></div><div class="ttdeci">RealTimeMessage realtimemessage</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d52/MIDIMessageQueue_8hpp_source.html#l00019">MIDIMessageQueue.hpp:19</a></div></div>
<div class="ttc" id="aunionMIDIMessageQueue_1_1MIDIMessageQueueElement_1_1Message_html_a9b71af9a038fbd69b126cbaa374b2ed4"><div class="ttname"><a href="../../db/d98/unionMIDIMessageQueue_1_1MIDIMessageQueueElement_1_1Message.html#a9b71af9a038fbd69b126cbaa374b2ed4">MIDIMessageQueue::MIDIMessageQueueElement::Message::syscommonmessage</a></div><div class="ttdeci">SysCommonMessage syscommonmessage</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d52/MIDIMessageQueue_8hpp_source.html#l00018">MIDIMessageQueue.hpp:18</a></div></div>
<div class="ttc" id="aunionMIDIMessageQueue_1_1MIDIMessageQueueElement_1_1Message_html_ac3130b4646bb682acc184d6fac12671a"><div class="ttname"><a href="../../db/d98/unionMIDIMessageQueue_1_1MIDIMessageQueueElement_1_1Message.html#ac3130b4646bb682acc184d6fac12671a">MIDIMessageQueue::MIDIMessageQueueElement::Message::sysexmessage</a></div><div class="ttdeci">SysExMessage sysexmessage</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d52/MIDIMessageQueue_8hpp_source.html#l00020">MIDIMessageQueue.hpp:20</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
