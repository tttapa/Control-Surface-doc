<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Control Surface: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/SVG"],
});
</script><script type="text/javascript" async="async" src="/MathJax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="custom_stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Control Surface
   &#160;<span id="projectnumber">1.1.0</span>
   </div>
   <div id="projectbrief">MIDI Control Surface library for Arduino</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Control Surface Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="https://github.com/tttapa/Control-Surface/actions"><img src="https://github.com/tttapa/Control-Surface/workflows/CI%20Tests/badge.svg" alt="Build Status" class="inline"/></a> <a href="https://tttapa.github.io/Control-Surface-doc/Coverage/index.html"><img src="https://img.shields.io/endpoint?url=https://raw.githubusercontent.com/tttapa/Control-Surface-doc/master/docs/Coverage/shield.io.coverage.json" alt="Test Coverage" class="inline"/></a> <a href="https://travis-ci.org/tttapa/Control-Surface"><img src="https://travis-ci.org/tttapa/Control-Surface.svg?branch=master" alt="Build Status" class="inline"/></a> <a href="https://github.com/tttapa/Control-Surface"><img src="https://img.shields.io/github/stars/tttapa/Control-Surface?label=GitHub&amp;logo=github" alt="GitHub" class="inline"/></a></p>
<h1><a class="anchor" id="autotoc_md163"></a>
Control Surface</h1>
<p>An Arduino library for MIDI control surfaces (input and output).</p>
<h2><a class="anchor" id="autotoc_md164"></a>
Overview</h2>
<p>This library turns your Arduino-compatible board into a MIDI control surface. <br  />
</p>
<p>Just connect up some push buttons, potentiometers, LEDs ... and declare them in your code.</p>
<p>Multiple different MIDI interfaces are supported: <b>MIDI over USB</b>, Serial MIDI (e.g. <b>5-pin DIN MIDI</b>), <b>Debug MIDI</b> (prints out the messages in a readable format, and allows you to input text based messages), <b>MIDI over Bluetooth LE</b> (experimental).</p>
<p>For MIDI output, you can use <b>push buttons</b>, toggle switches, <b>potentiometers</b>, faders, <b>rotary encoders</b>, etc.</p>
<p>All digital inputs are <b>debounced</b>, and all analog inputs are filtered using <b>digital filters and hysteresis</b>. This results in high accuracy without noise, without introducing latency.</p>
<p>These can be used to send MIDI notes, Control Changes, Pitch Bends, Program/Patch changes, etc.</p>
<p>For MIDI input, you can use <b>LEDs</b> to display the state of different settings, to display the audio level of each channel (<b>VU meters</b>), the positions of knobs (V-Pot <b>LED rings</b>), etc. <br  />
 You can also add an <b>OLED display</b> (e.g. SSD1306) to display a nice overview of which channels are set to mute or solo, display the time cursor, VU meters, etc. Bitmaps with play, mute, solo, record buttons, and others are included. <br  />
</p>
<p>A large portion of the <b>Mackie Control Universal</b> protocol is implemented.</p>
<p>All controls can be arranged in <b>banks</b>: e.g. if you have only 4 physical volume faders, you can add them to a bank, and then you can control 8 channels (or more) by changing the bank setting.</p>
<p>Apart from banks and bank selectors, you can also add <b>transposers</b> to change the key of your notes, for example.</p>
<p>In order to save some IO pins, the library natively supports <b>Shift Registers</b> (e.g. 74HC595) and <b>multiplexers</b> (e.g. 74HC4051 or 74HC4067).</p>
<p>If you are using a Teensy 3.x, you can use it as a <b>USB audio interface</b>. Just add an IÂ²S DAC (e.g. PCM5102), and 5 lines of code, and you can start playing audio through your Teensy. <br  />
 You can also add volume controls and VU meters for these audio connections.</p>
<p>Thanks to the structure of the library, you can easily add your own MIDI or display elements, using some minimal, high level code. All low level stuff is completely <b>reusable</b> (e.g. all MIDI operations, debouncing switches, filtering analog inputs, and so on).</p>
<h2><a class="anchor" id="autotoc_md165"></a>
The Control Surface library vs. The MIDI Controller library</h2>
<p>You might already have found my other Arduino MIDI library, <a href="https://github.com/tttapa/MIDI_Controller">MIDI Controller</a>, and are wondering which one you should use for your project.</p>
<p>First, some background: <br  />
 I first started working on the MIDI Controller library way back in 2015, and it evolved a lot early on. The library seemed to be pretty popular, and it worked pretty well, so I couldn't just push breaking changes every couple of months. <br  />
 Many people requested support for MIDI input, and I liked experimenting with it as well. The main problem was that the overall architecture of the library needed a complete overhaul in order to add MIDI input support. Since I didn't know if the MIDI input was going to work out, and I didn't want to break compatibility with older versions of the library, I decided to fork it: Control Surface was born. <br  />
 At the moment, I consider the MIDI Controller library "complete". I won't be adding any groundbreaking new features, but I will still be fixing bugs and providing support. <br  />
 Control Surface, on the other hand, is where the active development takes place.</p>
<p>The main difference between the two libraries is that Control Surface has much more features. MIDI Controller has everything you need for a working MIDI controller with potentiometers, push buttons, rotary encoders, etc., while Control Surface supports all of that, plus MIDI input, LEDs, VU meters, OLED displays, MIDI over Bluetooth, Audio over USB, etc. <br  />
 Another major difference is the documentation and tests. Control Surface tries to provide better documentation using Doxygen, and it has many unit tests to make sure I don't introduce any bugs.</p>
<p>For a new project, I would recommend Control Surface, because I think it has some great features compared to MIDI Controller. <br  />
 The only caveat is that this library is still under development. Master should always be relatively stable, but I might change the API of some parts of the library for future releases if necessary. <br  />
 Another thing is that not everything is implemented yet, and many features are not yet fully documented. If you have a specific feature request that is not yet fully implemented, feel free to open an issue, so I know where to focus on first.</p>
<h2><a class="anchor" id="autotoc_md166"></a>
Work in progress</h2>
<ul>
<li>Adding support for motorized faders</li>
<li>Cleaning up the display code</li>
<li>Cleaning up the MIDI over Bluetooth LE code</li>
<li>Adding more tests (currently at over 320 unit tests)</li>
<li>Adding more examples and adding comments to existing examples</li>
<li>Finishing the documentation</li>
</ul>
<h2><a class="anchor" id="autotoc_md167"></a>
Getting Started</h2>
<p>See the <a href="https://tttapa.github.io/Control-Surface-doc/Doxygen/d5/d7d/md_pages_Getting-Started.html"><b>Getting Started</b></a> document to get started using the library.</p>
<h2><a class="anchor" id="autotoc_md168"></a>
Documentation</h2>
<p>The automatically generated Doxygen documentation for this library can be found here: <br  />
 <a href="https://tttapa.github.io/Control-Surface-doc/Doxygen/index.html"><b>Documentation</b></a> <br  />
 Test coverage information can be found here: <br  />
 <a href="https://tttapa.github.io/Control-Surface-doc/Coverage/index.html"><b>Code Coverage</b></a> <br  />
 Arduino examples can be found here: <br  />
 <a href="https://tttapa.github.io/Control-Surface-doc/Doxygen/examples.html"><b>Examples</b></a></p>
<p>Have a look at the <a href="https://tttapa.github.io/Control-Surface-doc/Doxygen/modules.html"><b>modules</b></a> for an overview of the features of the library.</p>
<h2><a class="anchor" id="autotoc_md169"></a>
Supported boards</h2>
<p>For each commit, the continuous integration tests compile the examples for the following boards:</p>
<ul>
<li>Arduino UNO</li>
<li>Arduino Leonardo</li>
<li>Teensy 3.2</li>
<li>Arduino Due</li>
<li>Arduino Nano 33 IoT</li>
<li>ESP8266</li>
<li>ESP32</li>
</ul>
<p>This covers a very large part of the Arduino platform, and similar boards will also work (e.g. Arduino Nano, Arduino Mega, etc.).</p>
<p>If you have a board that's not supported, please <a href="https://github.com/tttapa/Control-Surface/issues/new">open an issue</a> and let me know!</p>
<p>Note that MIDI over USB and MIDI over Bluetooth are not supported on all boards. <br  />
 For MIDI over USB support, check out the <a href="https://tttapa.github.io/Control-Surface-doc/Doxygen/d8/d4a/md_pages_MIDI-over-USB.html"><b>MIDI over USB</b></a> documentation page. As a general rule of thumb, if your board is supported by the <a href="https://github.com/arduino-libraries/MIDIUSB">MIDIUSB library</a> or if it's a Teensy, MIDI over USB should be supported. <br  />
 MIDI over BLE is currently only supported on ESP32.</p>
<h2><a class="anchor" id="autotoc_md170"></a>
Information for developers</h2>
<p>Information for people that would like to help improve the Control Surface library can be found here: <a href="https://tttapa.github.io/Pages/Arduino/Control-Surface/Developers/index.html">https://tttapa.github.io/Pages/Arduino/Control-Surface/Developers/index.html</a> <br  />
 It covers installation instructions for developers, instructions for running the tests and generating documentation, a style guide, etc.</p>
<h2><a class="anchor" id="autotoc_md171"></a>
Recent Breaking Changes</h2>
<ul>
<li>bca6e11b2b3e02df5f600f65c81676708a81155b <br  />
 The color mapper for <code><a class="el" href="d8/d73/classNoteRangeFastLED.html">NoteRangeFastLED</a></code> and the like now takes a second parameter that represents the index of the LED within the LED strip.</li>
<li>3c01c7d5eb60e59720540d5a77095468e6984a58 <br  />
 The <b>maximum supported ADC resolution is now used by default</b> (e.g. 13 bits on Teensy 3.x, 12 bits on ESP32). <br  />
 This increases the accuracy of analog inputs and controls for the Control Surface library, but could cause problems if your code uses other libraries that expect the resolution to be 10 bits. <br  />
 You can change the default resolution to 10 bits in <a href="https://tttapa.github.io/Control-Surface-doc/Doxygen/dc/d69/namespaceAH.html#a4f2ec536d7413c6969f44d63ba14ce55"><code>src/AH/Settings/Settings.hpp</code></a> if you have to.</li>
<li>31edaa6b76477fdf152c19fd34f7e4e8506561e6 <br  />
 The <b>mapping function</b> is now applied before applying hysteresis. <br  />
 This means that the input and output values of the function should be 16 - <code>ANALOG_FILTER_SHIFT_FACTOR</code> bits wide instead of 7. By default this is <b>14 bits</b>. <br  />
 The signature of the mapping function is now <code>analog_t f(analog_t raw)</code>, where the return value and raw are both numbers in [0, 16383]. </li>
</ul>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
